var Ot=Object.defineProperty,Kt=Object.defineProperties;var Ht=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var Nt=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable;var Ye=(n,l,t)=>l in n?Ot(n,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[l]=t,I=(n,l)=>{for(var t in l||(l={}))Nt.call(l,t)&&Ye(n,t,l[t]);if(Qe)for(var t of Qe(l))zt.call(l,t)&&Ye(n,t,l[t]);return n},ge=(n,l)=>Kt(n,Ht(l));var Q=(n,l,t)=>new Promise((s,a)=>{var u=i=>{try{h(t.next(i))}catch(o){a(o)}},d=i=>{try{h(t.throw(i))}catch(o){a(o)}},h=i=>i.done?s(i.value):Promise.resolve(i.value).then(u,d);h((t=t.apply(n,l)).next())});import{d as ue,Z as H,_ as ye,N as pe,E as he,a0 as j,l as k,u as e,c as F,f as z,w as ve,H as Se,m as je,r as rt,h as Ge,o as We,x as De,an as Bt,J as ut,a7 as Lt,a8 as G,a9 as T,$ as re,a1 as we,ab as Y,F as Mt,aa as Ve,ag as Ut,e as Vt,ad as et,ai as Oe,aj as Ke,ac as tt,n as jt,z as Gt}from"./vue-f962b0e4.js";import{_ as Wt}from"./BasicForm.vue_vue_type_script_setup_true_lang-a006a9ee.js";import"./BasicForm.vue_vue_type_style_index_0_lang-81a6c1be.js";import{P as qe,b as qt,D as Jt,I as ze,A as Be,R as ce,F as Zt,u as Ae,d as Xt}from"./componentMap-e184fd7f.js";import{u as Qt}from"./useForm-c2beaf68.js";import{a1 as nt,f as $e,h as xe,H as Ne,Q as Yt,a2 as en,D as tn,G as nn,a3 as an,Z as ln,y as at,a4 as ft,a5 as on,V as sn,r as Ue,E as cn,P as rn,U as un}from"./index.js";import{aF as fn,af as Ce,aG as dn,aH as gn,f as me,e as J,k as Le,a as hn,aI as mn,aJ as Cn,ab as lt,o as Je,aE as pn,a1 as Pe,aK as vn,T as Te,a2 as dt,aL as Sn,d as ot,D as bn,w as He,aM as wn,aN as yn,aA as _n,az as Tn,aO as xn}from"./antd-c4849d31.js";import{a as Rn,u as gt,b as In,c as kn,d as Fn}from"./TableImg.vue_vue_type_style_index_0_lang-180d5827.js";import{b as st}from"./uuid-31b8b5a4.js";import Pn from"./sortable.esm-4ae27e0b.js";const Dn={class:"edit-header-cell"},it=ue({name:"EditTableHeaderIcon",__name:"EditTableHeaderIcon",props:{title:{type:String,default:""}},setup(n){return(l,t)=>(H(),ye("span",Dn,[pe(l.$slots,"default"),he(" "+j(n.title)+" ",1),k(e(fn))]))}}),An=ue({name:"TableHeaderCell",components:{EditTableHeaderCell:it,BasicHelp:nt},props:{column:{type:Object,default:()=>({})}},setup(n){const{prefixCls:l}=$e("basic-table-header-cell"),t=F(()=>{var u;return!!((u=n.column)!=null&&u.edit)}),s=F(()=>{var d;const u=n.column;return typeof u.customHeaderRender=="function"?u.customHeaderRender(u):(u==null?void 0:u.customTitle)||((d=n.column)==null?void 0:d.title)}),a=F(()=>{var u;return(u=n.column)==null?void 0:u.helpMessage});return()=>k("div",null,[t.value?k(it,null,{default:()=>[s.value]}):k("span",{class:"default-header-cell"},[s.value]),a.value&&k(nt,{text:a.value,class:`${l}__help`},null)])}});function $n({page:n,type:l,originalElement:t}){return l==="prev"?n===0?null:k(dn,null,null):l==="next"?n===1?null:k(gn,null,null):t}function En(n){const{t:l}=xe(),t=z({}),s=z(!0);ve(()=>e(n).pagination,o=>{!Ce(o)&&o&&(t.value=I(I({},e(t)),o!=null?o:{}))});const a=F(()=>{const{pagination:o}=e(n);return!e(s)||Ce(o)&&!o?!1:I(I({current:1,size:"small",defaultPageSize:qe,showTotal:y=>l("component.table.total",{total:y}),showSizeChanger:!0,pageSizeOptions:qt,itemRender:$n,showQuickJumper:!0},Ce(o)?{}:o),e(t))});function u(o){const y=e(a);t.value=I(I({},Ce(y)?{}:y),o)}function d(){return e(a)}function h(){return e(s)}function i(o){return Q(this,null,function*(){s.value=o})}return{getPagination:d,getPaginationInfo:a,setShowPagination:i,getShowPagination:h,setPagination:u}}function On(n){return({text:l,record:t,index:s})=>(Se(t).onValid=()=>Q(this,null,function*(){if(Ne(t==null?void 0:t.validCbs)){const a=((t==null?void 0:t.validCbs)||[]).map(d=>d());return(yield Promise.all(a)).every(d=>!!d)}else return!1}),Se(t).onEdit=(a,u=!1)=>Q(this,null,function*(){var d,h;return u||(t.editable=a),!a&&u?(yield t.onValid())&&(yield(d=t.onSubmitEdit)==null?void 0:d.call(t))?(t.editable=!1,!0):!1:(!a&&!u&&((h=t.onCancelEdit)==null||h.call(t)),!0)}),je(Rn,{value:l,record:t,column:n,index:s}))}function ht(n,l){const{key:t,dataIndex:s,children:a}=n;n.align=n.align||Jt,l&&(t||(n.key=typeof s=="object"?s.join("-"):s),Ce(n.ellipsis)||Object.assign(n,{ellipsis:l})),a&&a.length&&mt(a,!!l)}function mt(n,l){n&&n.forEach(t=>{const{children:s}=t;ht(t,l),mt(s,l)})}function Kn(n,l,t){const{t:s}=xe(),{showIndexColumn:a,indexColumnProps:u,isTreeTable:d}=e(n);let h=!1;if(e(d)||(t.forEach(()=>{const o=t.findIndex(y=>y.flag===ze);a?h=o===-1:!a&&o!==-1&&t.splice(o,1)}),!h))return;const i=t.some(o=>o.fixed==="left");t.unshift(I(I({flag:ze,width:60,title:s("component.table.index"),align:"center",customRender:({index:o})=>{const y=e(l);if(Ce(y))return`${o+1}`;const{current:A=1,pageSize:v=qe}=y;return((A<1?1:A)-1)*v+o+1}},i?{fixed:"left"}:{}),u))}function Hn(n,l){const{actionColumn:t}=e(n);if(!t)return;const s=l.findIndex(a=>a.flag===Be);s===-1&&l.push(ge(I(ge(I({},l[s]),{fixed:"right"}),t),{flag:Be}))}function Nn(n,l){const t=z(e(n).columns);let s=e(n).columns;const a=F(()=>{const r=me(e(t));if(Kn(n,l,r),Hn(n,r),!r)return[];const{ellipsis:f}=e(n);return r.forEach(b=>{const{customRender:_,slots:S}=b;ht(b,Reflect.has(b,"ellipsis")?!!b.ellipsis:!!f&&!_&&!S)}),r});function u(r){const f=r.ifShow;let b=!0;return Ce(f)&&(b=f),J(f)&&(b=f(r)),b}const{hasPermission:d}=Yt(),h=F(()=>{const r=ct(e(a)),f=_=>{const{slots:S,customRender:E,format:R,edit:K,editRow:V,flag:ee}=_;(!S||!(S!=null&&S.title))&&(_.customTitle=_.title);const te=[ze,Be].includes(ee);return!E&&R&&!K&&!te&&(_.customRender=({text:be,record:m,index:C})=>zn(be,R,m,C)),(K||V)&&!te&&(_.customRender=On(_)),rt(_)};return me(r).filter(_=>d(_.auth)&&u(_)).map(_=>{var S;return(S=_.children)!=null&&S.length&&(_.children=_.children.map(f)),f(_)})});ve(()=>e(n).columns,r=>{var f;t.value=r,s=(f=r==null?void 0:r.filter(b=>!b.flag))!=null?f:[]});function i(r,f){!r||!f||s.forEach(b=>{if(b.dataIndex===r){Object.assign(b,f);return}})}function o(r){const f=me(r);if(!Ne(f))return;if(f.length<=0){t.value=[];return}const b=f[0],_=s.map(S=>S.dataIndex);if(!Le(b)&&!Ne(b))t.value=f;else{const S=f.map(R=>R.toString()),E=[];s.forEach(R=>{var K;E.push(ge(I({},R),{defaultHidden:!S.includes(((K=R.dataIndex)==null?void 0:K.toString())||R.key)}))}),hn(_,f)||E.sort((R,K)=>{var V,ee;return S.indexOf((V=R.dataIndex)==null?void 0:V.toString())-S.indexOf((ee=K.dataIndex)==null?void 0:ee.toString())}),t.value=E}}function y(r){const{ignoreIndex:f,ignoreAction:b,sort:_}=r||{};let S=Se(e(a));return f&&(S=S.filter(E=>E.flag!==ze)),b&&(S=S.filter(E=>E.flag!==Be)),_&&(S=ct(S)),S}function A(){return s}function v(r){Ne(r)&&(s=r.filter(f=>!f.flag))}function x(r,f){f.width=r}return{getColumnsRef:a,getCacheColumns:A,getColumns:y,setColumns:o,setColumnWidth:x,getViewColumns:h,setCacheColumnsByField:i,setCacheColumns:v}}function ct(n){const l=[],t=[],s=[];for(const a of n){if(a.fixed==="left"){l.push(a);continue}if(a.fixed==="right"){t.push(a);continue}s.push(a)}return[...l,...s,...t].filter(a=>!a.defaultHidden)}function zn(n,l,t,s){if(!l)return n;if(J(l))return l(n,t,s);try{const a="date|";if(Le(l)&&l.startsWith(a)&&n){const u=l.replace(a,"");return u?en(n,u):n}if(mn(l))return l.get(n)}catch(a){return n}}function Bn(n,{getPaginationInfo:l,setPagination:t,setLoading:s,getFieldsValue:a,clearSelectedRowKeys:u,tableData:d},h){const i=rt({sortInfo:{},filterInfo:{}}),o=z([]),y=z({});Ge(()=>{d.value=e(o)}),ve(()=>e(n).dataSource,()=>{const{dataSource:m,api:C}=e(n);!C&&m&&(o.value=m)},{immediate:!0});function A(m,C,D){const{clearSelectOnPageChange:$,sortFn:B,filterFn:L}=e(n);$&&u(),t(m);const M={};if(D&&J(B)){const O=B(D);i.sortInfo=O,M.sortInfo=O}if(C&&J(L)){const O=L(C);i.filterInfo=O,M.filterInfo=O}K(M)}function v(m){!m||!Array.isArray(m)||m.forEach(C=>{C[ce]||(C[ce]=st()),C.children&&C.children.length&&v(C.children)})}const x=F(()=>e(n).autoCreateKey&&!e(n).rowKey),r=F(()=>{const{rowKey:m}=e(n);return e(x)?ce:m}),f=F(()=>{const m=e(o);if(!m||m.length===0)return e(o);if(e(x)){const C=m[0],D=m[m.length-1];if(C&&D&&(!C[ce]||!D[ce])){const $=me(e(o));$.forEach(B=>{B[ce]||(B[ce]=st()),B.children&&B.children.length&&v(B.children)}),o.value=$}}return e(o)});function b(m,C,D){return Q(this,null,function*(){return o.value[m]&&(o.value[m][C]=D),o.value[m]})}function _(m,C){const D=R(m);if(D){for(const $ in D)Reflect.has(C,$)&&(D[$]=C[$]);return D}}function S(m){var B;if(!o.value||o.value.length==0)return;const C=e(r);if(!C)return;const D=Array.isArray(m)?m:[m];function $(L,M){const O=ne(L,M);if(O===null||O.index===-1)return;O.data.splice(O.index,1);function ne(Z,ae){var le;if(Z==null)return null;for(let W=0;W<Z.length;W++){const q=Z[W];let oe=C;if(J(C)&&(oe=C(q)),q[oe]===ae)return{index:W,data:Z};if(((le=q.children)==null?void 0:le.length)>0){const fe=ne(q.children,ae);if(fe!=null)return fe}}return null}}for(const L of D)$(o.value,L),$(e(n).dataSource,L);t({total:(B=e(n).dataSource)==null?void 0:B.length})}function E(m,C){var $;C=C!=null?C:($=o.value)==null?void 0:$.length;const D=nn(m)?[m]:m;return e(o).splice(C,0,...D),e(o)}function R(m){if(!o.value||o.value.length==0)return;const C=e(r);if(!C)return;const{childrenColumnName:D="children"}=e(n);return(B=>{let L;return B.some(function M(O){if(typeof C=="function"){if(C(O)===m)return L=O,!0}else if(Reflect.has(O,C)&&O[C]===m)return L=O,!0;return O[D]&&O[D].some(M)}),L})(o.value)}function K(m){return Q(this,null,function*(){var Z,ae,le;const{api:C,searchInfo:D,defSort:$,fetchSetting:B,beforeFetch:L,afterFetch:M,useSearchForm:O,pagination:ne}=e(n);if(!(!C||!J(C)))try{s(!0);const{pageField:W,sizeField:q,listField:oe,totalField:fe}=Object.assign({},Zt,B);let de={};const{current:Re=1,pageSize:_e=qe}=e(l);Ce(ne)&&!ne||Ce(l)?de={}:(de[W]=m&&m.page||Re,de[q]=_e);const{sortInfo:Ie={},filterInfo:c}=i;let p=Cn(de,O?a():{},D,(Z=m==null?void 0:m.searchInfo)!=null?Z:{},$,Ie,c,(ae=m==null?void 0:m.sortInfo)!=null?ae:{},(le=m==null?void 0:m.filterInfo)!=null?le:{});L&&J(L)&&(p=(yield L(p))||p);const w=yield C(p);y.value=w;const g=Array.isArray(w);let P=g?w:lt(w,oe);const se=g?w.length:lt(w,fe);if(Number(se)){const ie=Math.ceil(se/_e);if(Re>ie)return t({current:ie}),yield K(m)}return M&&J(M)&&(P=(yield M(P))||P),o.value=P,t({total:se||0}),m&&m.page&&t({current:m.page||1}),h("fetch-success",{items:e(P),total:se}),P}catch(W){h("fetch-error",W),o.value=[],t({total:0})}finally{s(!1)}})}function V(m){o.value=m}function ee(){return f.value}function te(){return y.value}function be(m){return Q(this,null,function*(){return yield K(m)})}return We(()=>{tn(()=>{e(n).immediate&&K()},16)}),{getDataSourceRef:f,getDataSource:ee,getRawDataSource:te,getRowKey:r,setTableData:V,getAutoCreateKey:x,fetch:K,reload:be,updateTableData:b,updateTableDataRecord:_,deleteTableDataRecord:S,insertTableDataRecord:E,findTableDataRecord:R,handleTableChange:A}}function Ln(n){const l=z(e(n).loading);ve(()=>e(n).loading,a=>{l.value=a});const t=F(()=>e(l));function s(a){l.value=a}return{getLoading:t,setLoading:s}}function Mn(n,l,t){const s=z([]),a=z([]),u=F(()=>{const{rowSelection:f}=e(n);return f?I({selectedRowKeys:e(s),onChange:b=>{i(b)}},Je(f,["onChange"])):null});ve(()=>{var f;return(f=e(n).rowSelection)==null?void 0:f.selectedRowKeys},f=>{i(f)}),ve(()=>e(s),()=>{De(()=>{const{rowSelection:f}=e(n);if(f){const{onChange:b}=f;b&&J(b)&&b(v(),x())}t("selection-change",{keys:v(),rows:x()})})},{deep:!0});const d=F(()=>e(n).autoCreateKey&&!e(n).rowKey),h=F(()=>{const{rowKey:f}=e(n);return e(d)?ce:f});function i(f){var S;s.value=f||[];const b=an(Se(e(l)).concat(Se(e(a))),E=>f==null?void 0:f.includes(E[e(h)]),{children:(S=n.value.childrenColumnName)!=null?S:"children"}),_=[];f==null||f.forEach(E=>{const R=b.find(K=>K[e(h)]===E);R&&_.push(R)}),a.value=_}function o(f){a.value=f}function y(){a.value=[],s.value=[]}function A(f){const _=e(s).findIndex(S=>S===f);_!==-1&&e(s).splice(_,1)}function v(){return e(s)}function x(){return e(a)}function r(){return e(u)}return{getRowSelection:r,getRowSelectionRef:u,getSelectRows:x,getSelectRowKeys:v,setSelectedRowKeys:i,clearSelectedRowKeys:y,deleteSelectRowByKey:A,setSelectedRows:o}}function Un(n,l){let t;function s(u){return Q(this,null,function*(){var i;const{id:d}=u,h=t==null?void 0:t.querySelector(`[data-row-key="${d}"]`);yield De(),t==null||t.scrollTo({top:(i=h==null?void 0:h.offsetTop)!=null?i:0,behavior:"smooth"})})}function a(u){const d=e(n);if(!d)return;const h=d.$el;if(!h||!t&&(t=h.querySelector(".ant-table-body"),!t))return;const i=e(l);if(i)if(u==="top")s(i[0]);else if(u==="bottom")s(i[i.length-1]);else{const o=i.find(y=>y.id===u);o&&s(o)}}return{scrollTo:a}}function Vn(n,l,t){return!l||t?n[ce]:Le(l)?n[l]:J(l)?n[l(n)]:null}function jn(n,{setSelectedRowKeys:l,getSelectRowKeys:t,getAutoCreateKey:s,clearSelectedRowKeys:a,emit:u}){return{customRow:(h,i)=>({onClick:o=>{o==null||o.stopPropagation();function y(){var S;const{rowSelection:A,rowKey:v,clickToRowSelect:x}=e(n);if(!A||!x)return;const r=t()||[],f=Vn(h,v,e(s));if(f===null)return;if(A.type==="checkbox"){const E=(S=o.composedPath)==null?void 0:S.call(o).find(V=>V.tagName==="TR");if(!E)return;const R=E.querySelector("input[type=checkbox]");if(!R||R.hasAttribute("disabled"))return;if(!r.includes(f)){r.push(f),l(r);return}const K=r.findIndex(V=>V===f);r.splice(K,1),l(r);return}if(A.type==="radio"){if(!r.includes(f)){r.length&&a(),l([f]);return}a()}}y(),u("row-click",h,i,o)},onDblclick:o=>{u("row-dbClick",h,i,o)},onContextmenu:o=>{u("row-contextmenu",h,i,o)},onMouseenter:o=>{u("row-mouseenter",h,i,o)},onMouseleave:o=>{u("row-mouseleave",h,i,o)}})}}function Gn(n,l){function t(s,a){const{striped:u,rowClassName:d}=e(n),h=[];return u&&h.push((a||0)%2===1?`${l}-row__striped`:""),d&&J(d)&&h.push(d(s,a)),h.filter(i=>!!i).join(" ")}return{getRowClassName:t}}const Wn=["data-no"],qn=ue({name:"ColumnSetting",__name:"ColumnSetting",props:{cache:{type:Boolean,default:()=>!1}},emits:["columns-change"],setup(n,{emit:l}){const t=n,s=gt(),a=Bt(),{t:u}=xe(),{prefixCls:d}=$e("basic-column-setting"),h=ut(),i=Ae(),o=()=>J(h.getPopupContainer)?h.getPopupContainer():ft();let y=!1,A=!1;const v=z([]),x=z(null),r=z([]);ve(r,()=>{y&&(v.value.filter(c=>r.value.includes(c.value)).forEach(c=>{c.column.defaultHidden=!1}),v.value.filter(c=>!r.value.includes(c.value)).forEach(c=>{c.column.defaultHidden=!0,c.fixed=void 0}),ne(),$(),t.cache&&V())});const f=z(!1),b=()=>{r.value.length<v.value.length?r.value=v.value.map(c=>c.value):r.value=[]},_=F(()=>r.value.length>0&&r.value.length<v.value.length),S=z(!1),E=c=>{if(Z(c.target.checked),t.cache&&s.setShowIndexColumn(c.target.checked),c.target.checked){const p=me(i==null?void 0:i.getColumns()),w=p.findIndex(g=>g.flag==="INDEX");if(w>-1){const g=p[w];g.fixed="left",p.splice(w,1),p.splice(0,0,g),D(p)}}},R=z(!1),K=c=>{ae(c.target.checked),t.cache&&s.setShowRowSelection(c.target.checked)},V=()=>{typeof a.name=="string"&&s.setColumns(a.name,v.value)},ee=()=>{S.value=W,E({target:{checked:W}}),R.value=q,K({target:{checked:q}}),v.value=me(fe),le()},te=(c,p)=>{p==="left"?!c.fixed||c.fixed==="right"?c.fixed="left":c.fixed=void 0:p==="right"&&(!c.fixed||c.fixed==="left"?c.fixed="right":c.fixed=void 0),$(),t.cache&&V()},be=()=>Q(this,null,function*(){if(x.value){const c=x.value.$el;Array.from(c.children).forEach(p=>c.removeChild(p))}yield De()}),m=c=>{if(c){if("ifShow"in c){if(typeof c.ifShow=="boolean")return c.ifShow;if(c.ifShow)return c.ifShow(c)}return!0}return!1},C=()=>i.getColumns({ignoreIndex:!0,ignoreAction:!0}).filter(c=>m(c)),D=c=>{A=!0,i==null||i.setColumns(c);const p=c.map(w=>({dataIndex:w.dataIndex?w.dataIndex.toString():"",fixed:w.fixed,visible:!w.defaultHidden}));l("columns-change",p)},$=()=>{var g;const c=me(i.getColumns());let p=c.filter(P=>P.fixed==="left"||P.fixed===!0).length;for(const P of v.value){const se=c.findIndex(ie=>ie.dataIndex===P.value);if(se>-1){const ie=c[se];ie.defaultHidden=(g=P.column)==null?void 0:g.defaultHidden,ie.fixed=P.fixed,c.splice(se,1),c.splice(p++,0,ie)}}const w=c.findIndex(P=>P.dataIndex==="action");if(w>-1){const P=c.splice(w,1);c.push(P[0])}D(c)},B=()=>Q(this,null,function*(){if(yield De(),x.value){const c=x.value.$el;Pn.create(e(c),{animation:500,delay:400,delayOnTouchOnly:!0,handle:".table-column-drag-icon ",dataIdAttr:"data-no",onEnd:p=>{const{oldIndex:w,newIndex:g}=p;if(ot(w)||ot(g)||w===g)return;const P=me(v.value);w>g?(P.splice(g,0,P[w]),P.splice(w+1,1)):(P.splice(g+1,0,P[w]),P.splice(w,1)),v.value=P,$(),t.cache&&V()}})}}),L=()=>{if(typeof a.name=="string"){let c=s.getColumns(a.name);if(c&&JSON.stringify(v.value.map(p=>({value:p.value,label:p.label})))!==JSON.stringify(c.map(p=>({value:p.value,label:p.label})))){const p=v.value.reduce((w,g)=>(w[g.value]=g.label,w),{});if(Array.isArray(c)){c=c.filter(g=>p[g.value]),c.forEach(g=>{g.label=p[g.value]});const w=c.map(g=>g.value);c=c.concat(v.value.filter(g=>!w.includes(g.value))),s.setColumns(a.name,c)}}}},M=()=>{if(typeof s.getShowIndexColumn=="boolean"&&(S.value=s.getShowIndexColumn),typeof s.getShowRowSelection=="boolean"&&(R.value=q&&s.getShowRowSelection),E({target:{checked:S.value}}),K({target:{checked:R.value}}),typeof a.name=="string"){const c=s.getColumns(a.name);Array.isArray(c)&&(v.value=c)}},O=()=>{r.value=v.value.filter(c=>{var p;return!((p=c.column)!=null&&p.defaultHidden)}).map(c=>c.value)},ne=()=>{f.value=v.value.length===r.value.length},Z=c=>{A=!0,i.setProps({showIndexColumn:c})},ae=c=>{A=!0,i.setProps({rowSelection:c?ge(I({},Je(oe,["selectedRowKeys"])),{fixed:!0}):void 0})},le=()=>{O(),ne(),Z(S.value),ae(R.value),$()};let W=!1,q=!1,oe,fe=[];const de=()=>Q(this,null,function*(){var c;if(!y){const p=C();(c=i.setCacheColumns)==null||c.call(i,p);const w=[];for(const g of p)w.push({label:typeof g.title=="string"?g.title:g.customTitle==="string"?g.customTitle:"",value:typeof g.dataIndex=="string"?g.dataIndex:g.title==="string"?g.title:"",column:{defaultHidden:g.defaultHidden},fixed:g.fixed});W=i.getBindValues.value.showIndexColumn||!1,oe=i.getRowSelection(),q=!!oe,fe=w,S.value=W,R.value=q,v.value=me(w),t.cache&&L(),t.cache&&M(),le(),y=!0}});(()=>Q(this,null,function*(){yield be(),de()}))();const _e=F(()=>i==null?void 0:i.getColumns()),Ie=F(()=>i==null?void 0:i.getBindValues);return We(()=>{ve([_e,Ie],()=>{A?A=!1:(y=!1,de())})}),(c,p)=>{const w=Lt("a-button");return H(),G(e(Te),{placement:"top"},{title:T(()=>[re("span",null,j(e(u)("component.table.settingColumn")),1)]),default:T(()=>[k(e(pn),{placement:"bottomLeft",trigger:"click",onOpenChange:B,overlayClassName:`${e(d)}__column-list`,getPopupContainer:o},{title:T(()=>[re("div",{class:we(`${e(d)}__popover-title`)},[k(e(Pe),{indeterminate:_.value,checked:f.value,"onUpdate:checked":p[0]||(p[0]=g=>f.value=g),onChange:b},{default:T(()=>[he(j(e(u)("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked"]),k(e(Pe),{checked:S.value,"onUpdate:checked":p[1]||(p[1]=g=>S.value=g),onChange:E},{default:T(()=>[he(j(e(u)("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked"]),e(q)?(H(),G(e(Pe),{key:0,checked:R.value,"onUpdate:checked":p[2]||(p[2]=g=>R.value=g),onChange:K},{default:T(()=>[he(j(e(u)("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked"])):Y("",!0),k(w,{size:"small",type:"link",onClick:ee},{default:T(()=>[he(j(e(u)("common.resetText")),1)]),_:1})],2)]),content:T(()=>[k(e(ln),null,{default:T(()=>[k(e(Pe).Group,{value:r.value,"onUpdate:value":p[3]||(p[3]=g=>r.value=g),ref_key:"columnOptionsRef",ref:x},{default:T(()=>[(H(!0),ye(Mt,null,Ve(v.value,g=>(H(),ye("div",{key:g.value,class:we(`${e(d)}__check-item`),"data-no":g.value},[k(e(vn),{class:"table-column-drag-icon"}),k(e(Pe),{value:g.value},{default:T(()=>[he(j(g.label),1)]),_:2},1032,["value"]),k(e(Te),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:o},{title:T(()=>[he(j(e(u)("component.table.settingFixedLeft")),1)]),default:T(()=>[k(at,{icon:"line-md:arrow-align-left",class:we([`${e(d)}__fixed-left`,{active:g.fixed==="left",disabled:g.value?!r.value.includes(g.value):!0}]),onClick:P=>te(g,"left")},null,8,["class","onClick"])]),_:2},1024),k(e(dt),{type:"vertical"}),k(e(Te),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:o},{title:T(()=>[he(j(e(u)("component.table.settingFixedRight")),1)]),default:T(()=>[k(at,{icon:"line-md:arrow-align-left",class:we([`${e(d)}__fixed-right`,{active:g.fixed==="right",disabled:g.value?!r.value.includes(g.value):!0}]),onClick:P=>te(g,"right")},null,8,["class","onClick"])]),_:2},1024)],10,Wn))),128))]),_:1},8,["value"])]),_:1})]),default:T(()=>[k(e(Sn))]),_:1},8,["overlayClassName"])]),_:1})}}}),Jn=ue({name:"SizeSetting",__name:"SizeSetting",setup(n){const l=gt(),t=Ae(),{t:s}=xe(),a=z([t.getSize()]),u=({key:d})=>{a.value=[d],l.setTableSize(d),t.setProps({size:d})};return We(()=>{a.value=[l.getTableSize],t.setProps({size:a.value[0]})}),(d,h)=>(H(),G(e(Te),{placement:"top"},{title:T(()=>[re("span",null,j(e(s)("component.table.settingDens")),1)]),default:T(()=>[k(e(bn),{placement:"bottom",trigger:["click"],getPopupContainer:e(ft)},{overlay:T(()=>[k(e(He),{onClick:u,selectable:"",selectedKeys:a.value,"onUpdate:selectedKeys":h[0]||(h[0]=i=>a.value=i)},{default:T(()=>[k(e(He).Item,{key:"default"},{default:T(()=>[re("span",null,j(e(s)("component.table.settingDensDefault")),1)]),_:1}),k(e(He).Item,{key:"middle"},{default:T(()=>[re("span",null,j(e(s)("component.table.settingDensMiddle")),1)]),_:1}),k(e(He).Item,{key:"small"},{default:T(()=>[re("span",null,j(e(s)("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["selectedKeys"])]),default:T(()=>[k(e(wn))]),_:1},8,["getPopupContainer"])]),_:1}))}}),Zn=ue({name:"RedoSetting",__name:"RedoSetting",setup(n){const l=Ae(),{t}=xe();function s(){l.reload()}return(a,u)=>(H(),G(e(Te),{placement:"top"},{title:T(()=>[re("span",null,j(e(t)("common.redo")),1)]),default:T(()=>[k(e(yn),{onClick:s})]),_:1}))}}),Xn=ue({name:"FullScreenSetting",__name:"FullScreenSetting",setup(n){const l=Ae(),{t}=xe(),{toggle:s,isFullscreen:a}=on(l.wrapRef);return(u,d)=>(H(),G(e(Te),{placement:"top"},{title:T(()=>[re("span",null,j(e(t)("component.table.settingFullScreen")),1)]),default:T(()=>[e(a)?(H(),G(e(Tn),{key:1,onClick:e(s)},null,8,["onClick"])):(H(),G(e(_n),{key:0,onClick:e(s)},null,8,["onClick"]))]),_:1}))}}),Qn={class:"table-settings"},Yn=ue({name:"TableSetting",__name:"index",props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(n,{emit:l}){const t=n,s=Ae(),a=F(()=>I({redo:!0,size:!0,setting:!0,settingCache:!1,fullScreen:!1},t.setting));function u(h){l("columns-change",h)}function d(){return s?e(s.wrapRef):document.body}return(h,i)=>(H(),ye("div",Qn,[a.value.redo?(H(),G(Zn,{key:0,getPopupContainer:d})):Y("",!0),a.value.size?(H(),G(Jn,{key:1,getPopupContainer:d})):Y("",!0),a.value.setting?(H(),G(qn,{key:2,onColumnsChange:u,getPopupContainer:d,cache:a.value.settingCache},null,8,["cache"])):Y("",!0),a.value.fullScreen?(H(),G(Xn,{key:3,getPopupContainer:d})):Y("",!0)]))}}),ea=ue({name:"BasicTableTitle",__name:"TableTitle",props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(n){const l=n,{prefixCls:t}=$e("basic-table-title"),s=F(()=>{const{title:a,getSelectRows:u=()=>{}}=l;let d=a;return J(a)&&(d=a({selectRows:u()})),d});return(a,u)=>s.value?(H(),G(e(sn),{key:0,class:we(e(t)),helpMessage:n.helpMessage},{default:T(()=>[he(j(s.value),1)]),_:1},8,["class","helpMessage"])):Y("",!0)}}),ta={style:{width:"100%"}},na={key:0,style:{margin:"5px"}},aa={class:"flex items-center"},la=ue({name:"BasicTableHeader",__name:"TableHeader",props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""}},emits:["columns-change"],setup(n,{emit:l}){const{prefixCls:t}=$e("basic-table-header");function s(a){l("columns-change",a)}return(a,u)=>(H(),ye("div",ta,[a.$slots.headerTop?(H(),ye("div",na,[pe(a.$slots,"headerTop")])):Y("",!0),re("div",aa,[a.$slots.tableTitle?pe(a.$slots,"tableTitle",{key:0}):Y("",!0),!a.$slots.tableTitle&&n.title?(H(),G(ea,{key:1,helpMessage:n.titleHelpMessage,title:n.title},null,8,["helpMessage","title"])):Y("",!0),re("div",{class:we(`${e(t)}__toolbar`)},[pe(a.$slots,"toolbar"),a.$slots.toolbar&&n.showTableSetting?(H(),G(e(dt),{key:0,type:"vertical"})):Y("",!0),n.showTableSetting?(H(),G(Yn,{key:1,setting:n.tableSetting,onColumnsChange:s},null,8,["setting"])):Y("",!0)],2)])]))}});function oa(n,l,t){return{getHeaderProps:F(()=>{const{title:a,showTableSetting:u,titleHelpMessage:d,tableSetting:h}=e(n),i=!l.tableTitle&&!a&&!l.toolbar&&!u;return i&&!Le(a)?{}:{title:i?null:()=>je(la,{title:a,titleHelpMessage:d,showTableSetting:u,tableSetting:h,onColumnsChange:t.onColumnsChange},I(I(I({},l.toolbar?{toolbar:()=>Ue(l,"toolbar")}:{}),l.tableTitle?{tableTitle:()=>Ue(l,"tableTitle")}:{}),l.headerTop?{headerTop:()=>Ue(l,"headerTop")}:{}))}})}}function sa(n,l,t){const s=z([]),a=F(()=>e(n).autoCreateKey&&!e(n).rowKey),u=F(()=>{const{rowKey:v}=e(n);return e(a)?ce:v}),d=F(()=>{const{isTreeTable:v}=e(n);return v?{expandedRowKeys:e(s),onExpandedRowsChange:x=>{s.value=x,t("expanded-rows-change",x)}}:{}});function h(){const v=A();s.value=v}function i(){s.value=[]}function o(v){const{isTreeTable:x}=e(n);x&&(s.value=[...s.value,...v])}function y(v){const{isTreeTable:x}=e(n);x&&(s.value=e(s).filter(r=>!v.includes(r)))}function A(v){const x=[],{childrenColumnName:r}=e(n);return Se(v||e(l)).forEach(f=>{x.push(f[e(u)]);const b=f[r||"children"];b!=null&&b.length&&x.push(...A(b))}),x}return{getExpandOption:d,expandAll:h,collapseAll:i,expandRows:o,collapseRows:y}}function ia(n,l,t,s){const a=F(()=>(e(s)||[]).length===0),u=F(()=>{const{summaryFunc:h,showSummary:i,summaryData:o}=e(n);return i&&!e(a)?()=>je(In,{summaryFunc:h,summaryData:o,scroll:e(l)}):void 0});Ge(()=>{d()});function d(){const{showSummary:h}=e(n);!h||e(a)||De(()=>{const i=e(t);if(!i)return;const o=i.$el.querySelector(" .ant-table-content,  .ant-table-body");cn({el:o,name:"scroll",listener:()=>{const y=i.$el.querySelector('.ant-table-footer .ant-table-container  [class^="ant-table-"]');!y||!o||(y.scrollLeft=o.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:u}}function ca(n,l,t,s){const a=F(()=>{const{formConfig:i}=e(n),{submitButtonOptions:o}=i||{};return ge(I({showAdvancedButton:!0},i),{submitButtonOptions:I({loading:e(s)},o),compact:!0})}),u=F(()=>Object.keys(l).map(o=>o.startsWith("form-")?o:null).filter(o=>!!o));function d(i){var o,y;return i&&(y=(o=i==null?void 0:i.replace)==null?void 0:o.call(i,/form-/,""))!=null?y:""}function h(i){const{handleSearchInfoFn:o}=e(n);o&&J(o)&&(i=o(i)||i),t({searchInfo:i,page:1})}return{getFormProps:a,replaceFormSlotKey:d,getFormSlotKeys:u,handleSearchInfoChange:h}}const ba=ue({name:"BasicTable",__name:"BasicTable",props:kn,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(n,{expose:l,emit:t}){const s=n,a=ut(),u=Ut(),d=z(null),h=z([]),i=z(null),o=z(null),y=z(),{prefixCls:A}=$e("basic-table"),[v,x]=Qt(),r=F(()=>I(I({},s),e(y))),f=Vt(rn,!1);Ge(()=>{e(f)&&s.canResize&&un()});const{getLoading:b,setLoading:_}=Ln(r),{getPaginationInfo:S,getPagination:E,setPagination:R,setShowPagination:K,getShowPagination:V}=En(r),{getRowSelection:ee,getRowSelectionRef:te,getSelectRows:be,setSelectedRows:m,clearSelectedRowKeys:C,getSelectRowKeys:D,deleteSelectRowByKey:$,setSelectedRowKeys:B}=Mn(r,h,t),{handleTableChange:L,getDataSourceRef:M,getDataSource:O,getRawDataSource:ne,setTableData:Z,updateTableDataRecord:ae,deleteTableDataRecord:le,insertTableDataRecord:W,findTableDataRecord:q,fetch:oe,getRowKey:fe,reload:de,getAutoCreateKey:Re,updateTableData:_e}=Bn(r,{tableData:h,getPaginationInfo:S,setLoading:_,setPagination:R,getFieldsValue:x.getFieldsValue,clearSelectedRowKeys:C},t);function Ie(N,X,U,Fe){L(N,X,U),t("change",N,X,U);const{onChange:Me}=e(r);Me&&J(Me)&&Me(N,X,U,Fe)}const{getViewColumns:c,getColumns:p,setCacheColumnsByField:w,setCacheColumns:g,setColumnWidth:P,setColumns:se,getColumnsRef:ie,getCacheColumns:Ct}=Nn(r,S),{getScrollRef:Ze,redoHeight:Xe}=Fn(r,d,ie,te,M,i,o),{scrollTo:pt}=Un(d,M),{customRow:vt}=jn(r,{setSelectedRowKeys:B,getSelectRowKeys:D,clearSelectedRowKeys:C,getAutoCreateKey:Re,emit:t}),{getRowClassName:St}=Gn(r,A),{getExpandOption:bt,expandAll:wt,expandRows:yt,collapseRows:_t,collapseAll:Tt}=sa(r,h,t),xt={onColumnsChange:N=>{var X,U;t("columns-change",N),(U=(X=e(r)).onColumnsChange)==null||U.call(X,N)}},{getHeaderProps:Rt}=oa(r,u,xt),{getFooterProps:It}=ia(r,Ze,d,M),{getFormProps:kt,replaceFormSlotKey:Ft,getFormSlotKeys:Pt,handleSearchInfoChange:Dt}=ca(r,u,oe,b),ke=F(()=>{const N=e(M);let X=I(ge(I(I(ge(I({},a),{customRow:vt}),e(r)),e(Rt)),{scroll:e(Ze),loading:e(b),tableLayout:"fixed",rowSelection:e(te),rowKey:e(fe),columns:Se(e(c)),pagination:Se(e(S)),dataSource:N,footer:e(It)}),e(bt));return X=Je(X,["class","onChange"]),X}),At=F(()=>{const N=e(ke);return[A,a.class,{[`${A}-form-container`]:N.useSearchForm,[`${A}--inset`]:N.inset}]}),$t=F(()=>{const{emptyDataIsShowTable:N,useSearchForm:X}=e(r);return N||!X?!0:!!e(M).length});function Et(N){y.value=I(I({},e(y)),N)}const Ee={reload:de,getSelectRows:be,setSelectedRows:m,clearSelectedRowKeys:C,getSelectRowKeys:D,deleteSelectRowByKey:$,setPagination:R,setTableData:Z,updateTableDataRecord:ae,deleteTableDataRecord:le,insertTableDataRecord:W,findTableDataRecord:q,redoHeight:Xe,setSelectedRowKeys:B,setColumns:se,setLoading:_,getDataSource:O,getRawDataSource:ne,setProps:Et,getRowSelection:ee,getPaginationRef:E,getColumns:p,getCacheColumns:Ct,emit:t,updateTableData:_e,setShowPagination:K,getShowPagination:V,setCacheColumnsByField:w,expandAll:wt,collapseAll:Tt,expandRows:yt,collapseRows:_t,scrollTo:pt,getSize:()=>e(ke).size,setCacheColumns:g};return Xt(ge(I({},Ee),{wrapRef:i,getBindValues:ke})),t("register",Ee,x),l(I({tableElRef:d},Ee)),(N,X)=>(H(),ye("div",{ref_key:"wrapRef",ref:i,class:we(At.value)},[ke.value.useSearchForm?(H(),G(e(Wt),tt({key:0,ref_key:"formRef",ref:o,submitOnReset:""},e(kt),{tableAction:Ee,onRegister:e(v),onSubmit:e(Dt),onAdvancedChange:e(Xe)}),et({_:2},[Ve(e(Pt),U=>({name:e(Ft)(U),fn:T(Fe=>[pe(N.$slots,U,Oe(Ke(Fe||{})))])}))]),1040,["onRegister","onSubmit","onAdvancedChange"])):Y("",!0),jt(k(e(xn),tt({ref_key:"tableElRef",ref:d},ke.value,{rowClassName:e(St),onChange:Ie,onResizeColumn:e(P)}),et({headerCell:T(({column:U})=>[pe(N.$slots,"headerCell",Oe(Ke({column:U})),()=>[k(An,{column:U},null,8,["column"])])]),bodyCell:T(U=>[pe(N.$slots,"bodyCell",Oe(Ke(U||{})))]),_:2},[Ve(Object.keys(N.$slots),U=>({name:U,fn:T(Fe=>[pe(N.$slots,U,Oe(Ke(Fe||{})))])}))]),1040,["rowClassName","onResizeColumn"]),[[Gt,$t.value]])],2))}});export{ba as _,An as a};
