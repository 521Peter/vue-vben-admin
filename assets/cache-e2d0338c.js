import{u as E,g as p,c as y}from"./mock-api-d87b85f1.js";import{P as D}from"./index-c8d55b3e.js";import{b3 as s,B as F,N as i,V as g,z as k,h as K}from"./antd-c4849d31.js";import{d as c,l as u,f as C,E as e,u as d,F as B}from"./vue-f962b0e4.js";import"./index.js";import"./useContentViewHeight-8b859986.js";import"./useWindowSizeFn-01ffbee2.js";import"./onMountedOrActivated-affa4888.js";const o=c({props:{cacheKey:{type:String,default:"cacheKey-demo"}},setup(l){const{loading:n,data:a}=E(p,{cacheKey:l.cacheKey});return()=>{var t,r;return u(B,null,[u("p",null,[e("Background loading: "),n.value?"true":"false"]),u("p",null,[e("Latest request time: "),(t=d(a))==null?void 0:t.time]),u("p",null,[(r=d(a))==null?void 0:r.data])])}}}),P=c({setup(){const l=C(!1),n=a=>{l.value=a!=null?a:!l.value};return()=>u(i,{title:"SWR"},{default:()=>[u(s,null,{default:()=>[u(s.Paragraph,null,{default:()=>[e("下面的示例，我们设置了"),u(s.Text,{type:"danger"},{default:()=>[e(" cacheKey ")]}),e("，在组件第二次加载时，会优先返回缓存的内容，然后在背后重新发起请求。你可以通过点击按钮来体验效果。")]})]}),u("div",{class:"mt-4"},[u(F,{type:"primary",onClick:()=>n()},{default:()=>[l.value?"hidden":"show"]}),l.value&&u(o,null,null)])]})}}),T=c({setup(){const{loading:l,data:n}=E(p,{cacheKey:"staleTime-demo",staleTime:5e3});return()=>{var a,t;return u(B,null,[u("p",null,[e("Background loading: "),l.value?"true":"false"]),u("p",null,[e("Latest request time: "),(a=d(n))==null?void 0:a.time]),u("p",null,[(t=d(n))==null?void 0:t.data])])}}}),q=c({setup(){const l=C(!1),n=a=>{l.value=a!=null?a:!l.value};return()=>u(i,{title:"数据保持新鲜",class:"mt-2"},{default:()=>[u(s,null,{default:()=>[u(s.Paragraph,null,{default:()=>[e("通过设置"),u(s.Text,{type:"danger"},{default:()=>[e(" staleTime ")]}),e("，我们可以指定数据新鲜时间，在这个时间内，不会重新发起请求。下面的示例设置了 5s 的新鲜时间，你可以通过点击按钮来体验效果")]})]}),u("div",{class:"mt-4"},[u(F,{type:"primary",onClick:()=>n()},{default:()=>[l.value?"hidden":"show"]}),l.value&&u(T,null,null)])]})}}),h=c({setup(){const{loading:l,data:n,refresh:a}=E(p,{cacheKey:"cacheKey-share"});return()=>{var t,r;return u(B,null,[u("p",null,[e("Background loading: "),l.value?"true":"false"]),u(F,{type:"primary",onClick:a},{default:()=>[e("更新")]}),u("p",null,[e("Latest request time: "),(t=d(n))==null?void 0:t.time]),u("p",null,[(r=d(n))==null?void 0:r.data])])}}}),x=c({setup(){return()=>u(i,{title:"数据共享",class:"mt-2"},{default:()=>[u(s,null,{default:()=>[u(s.Paragraph,null,{default:()=>[e("同一个"),u(s.Text,{type:"danger"},{default:()=>[e(" cacheKey ")]}),e("的内容，在全局是共享的，这会带来以下几个特性")]}),u(s.Paragraph,null,{default:()=>[u("ul",null,[u("li",null,[e("请求 Promise 共享，相同的"),u(s.Text,{type:"danger"},{default:()=>[e(" cacheKey ")]}),e("同时只会有一个在发起请求，后发起的会共用同一个请求 Promise")]),u("li",null,[e("数据同步，任何时候，当我们改变其中某个 cacheKey 的内容时，其它相同"),u(s.Text,{type:"danger"},{default:()=>[e(" cacheKey ")]}),e("的内容均会同步")])])]})]}),u("div",{class:"mt-4"},[u("h2",null,[e("Article 1")]),u(h,null,null),u("h2",null,[e("Article 2")]),u(h,null,null)])]})}}),S=c({setup(){var A;const{loading:l,data:n,params:a,run:t}=E(p,{cacheKey:"cacheKey-share4"}),r=C(((A=a.value)==null?void 0:A[0])||"");return()=>{var m,f;return u(B,null,[u(g,null,{default:()=>[u(k,{value:r.value,"onUpdate:value":v=>r.value=v},null),u(F,{onClick:()=>t(r.value)},{default:()=>[e("Get")]})]}),u("p",null,[e("Background loading: "),l.value?"true":"false"]),u("p",null,[e("Latest request time: "),(m=d(n))==null?void 0:m.time]),u("p",null,[e("Latest request data: "),(f=d(n))==null?void 0:f.data]),u("p",null,[e("keyword: "),r.value])])}}}),w=c({setup(){const l=C(!1),n=a=>{l.value=a!=null?a:!l.value};return()=>u(i,{title:"参数缓存",class:"mt-2"},{default:()=>[u(s,null,{default:()=>[u(s.Paragraph,null,{default:()=>[e("缓存的数据包括 data 和 params，通过 params 缓存机制，我们可以记忆上一次请求的条件，并在下次初始化")]})]}),u("div",{class:"mt-4"},[u(F,{type:"primary",onClick:()=>n()},{default:()=>[l.value?"hidden":"show"]}),u("div",{class:"mt-2"},[l.value&&u(S,null,null)])])]})}}),L=c({setup(){const l=C(!1),n=t=>{l.value=t!=null?t:!l.value},a=t=>{y(t);const r=Array.isArray(t)?t.join("、"):t;K.success(`Clear ${r!=null?r:"All"} finished`)};return()=>u(i,{title:"删除缓存",class:"mt-2"},{default:()=>[u(s,null,{default:()=>[u(s.Paragraph,null,{default:()=>[e("useRequest 提供了一个 clearCache 方法，可以清除指定 cacheKey 的缓存数据。")]})]}),u("div",{class:"mt-4"},[u(g,null,{default:()=>[u(F,{type:"primary",onClick:()=>n()},{default:()=>[l.value?"hidden":"show"]}),u(F,{onClick:()=>a("Article1")},{default:()=>[e("Clear Article1")]}),u(F,{onClick:()=>a("Article2")},{default:()=>[e("Clear Article2")]}),u(F,{onClick:()=>a(["Article2","Article3"])},{default:()=>[e("Clear Article2 and Article3")]}),u(F,{onClick:()=>a()},{default:()=>[e("Clear All")]})]}),u("h2",null,[e("Article 1")]),l.value&&u(o,{cacheKey:"Article1"},null),u("h2",null,[e("Article 2")]),l.value&&u(o,{cacheKey:"Article2"},null),u("h2",null,[e("Article 3")]),l.value&&u(o,{cacheKey:"Article3"},null)])]})}}),N=c({setup(){const l="setCache-demo6",{loading:n,data:a}=E(p,{cacheKey:l,setCache:t=>localStorage.setItem(l,JSON.stringify(t)),getCache:()=>JSON.parse(localStorage.getItem(l)||"{}")});return()=>{var t,r;return u(B,null,[u("p",null,[e("Background loading: "),n.value?"true":"false"]),u("p",null,[e("Latest request time: "),(t=d(a))==null?void 0:t.time]),u("p",null,[(r=d(a))==null?void 0:r.data])])}}}),I=c({setup(){const l=C(!1),n=a=>{l.value=a!=null?a:!l.value};return()=>u(i,{title:"自定义缓存",class:"mt-2"},{default:()=>[u(s,null,{default:()=>[u(s.Paragraph,null,{default:()=>[e("通过配置 setCache 和 getCache，可以自定义数据缓存，比如可以将数据存储到 localStorage、IndexDB 等。")]})]}),u("div",{class:"mt-4"},[u(F,{type:"primary",onClick:()=>n()},{default:()=>[l.value?"hidden":"show"]}),u("div",{class:"mt-2"},[l.value&&u(N,null,null)])])]})}}),U=c({setup(){return()=>u(D,null,{default:()=>[u(P,null,null),u(q,null,null),u(x,null,null),u(w,null,null),u(L,null,null),u(I,null,null)]})}});export{U as default};
